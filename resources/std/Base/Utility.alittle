namespace ALittle;

private auto __lshift = bit.lshift;
private auto __rshift = bit.rshift;
private auto __bxor = bit.bxor;

private auto __byte = String.byte;
private auto __sub = String.sub;
private auto __len = String.len;

// 哈希函数
public static JSHash(string str) : int
{
    auto l = __len(str);
    auto h = l;
    auto step = __rshift(l, 5) + 1;

    for (auto i=l,step,-step)
        h = __bxor(h, (__lshift(h, 5) + __byte(str, i) + __rshift(h, 2)));

    return h;
}
